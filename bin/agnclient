#!/bin/sh
# Name : agnclient
# Description: This wrapper solves a permissions 
#  limitation for home directories mounted off of an NFS
#  share that is not exported with no_root_squash
# Authors: Paul Szepietowski
#          Jenny Aquilino
#

temp_home_dir=/tmp/agnclient_temp_home_dir_${USER}_${$}_${PPID}

/bin/mkdir -p $temp_home_dir
mkdir_rc=$?

if [[ $mkdir_rc != 0 ]] ; then
  echo "ERROR : Temporary home directory failed to be created, exiting."
  echo "ERROR : Temporary home directory is $temp_home_dir"
  return 1
  fi


echo
echo "WARNING : Please be sure to open the site firewall for six (6) hours."
echo "INFO : For example, run 'lynx cnn.com' to authenticate against the web proxy."
echo
/bin/sleep 1

/usr/bin/env HOME=$temp_home_dir /opt/agns/bin/agnclient &

(
  /bin/sleep 300
  /usr/bin/nohup /bin/ping bg109.watson.ibm.com >&- 2>&- &
  ) &

